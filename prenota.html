<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Piscina Eden</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.css">
    <link rel="stylesheet" href="style.css">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>

    <header class="header clearfix">
        <a href="index.html" class="header__logo">Eden Pool&Restaurant</a>
        <a href="" class="header__icon-bar">
            <span></span>
            <span></span>
            <span></span>
        </a>
        <ul class="header__menu animate">
            <li class="header__menu__item"><a href="index.html">HOME</a></li>
            <hr class="hr">
            <li class="header__menu__item"><a href="giugno.html" onclick="localStorage.setItem('mese',6)">GIUGNO</a>
            </li>
            <hr class="hr">
            <li class="header__menu__item"><a href="luglio.html" onclick="localStorage.setItem('mese',7)">LUGLIO</a>
            </li>
            <hr class="hr">
            <li class="header__menu__item"><a href="agosto.html" onclick="localStorage.setItem('mese',8)">AGOSTO</a>
            </li>
            <hr class="hr">
            <li class="header__menu__item"><a href="settembre.html" onclick="localStorage.setItem('mese',9)">SETTEMBRE</a></li>
            <hr class="hr">
            <li class="header__menu__item"><a href="info.html">INFO</a></li>
        </ul>
    </header>

    <section class="white__space">
        <span></span>
        <span></span>
        <span></span>
    </section>
    <div class="wrapper">
        <form class="form">
            <fieldset class="fieldset">
                <legend class="legend">RIEPILOGO</legend>
                <p class="riepilogo" id="data"></p>
                <p class="riepilogo" id="ora"></p>
            </fieldset>
            <fieldset class="fieldset_appartamento">
                <legend class="legend_appartamento">APPARTAMENTO</legend>
                <select class="text" type="text" name="numero" list="appartamenti">
                    <option value="">SELEZIONA</option>
                    <option value="1">APPARTAMENTO 1</option>
                    <option value="2">APPARTAMENTO 2</option>
                    <option value="3">APPARTAMENTO 3</option>
                    <option value="4">APPARTAMENTO 4</option>
                    <option value="5">APPARTAMENTO 5</option>
                    <option value="6">APPARTAMENTO 6</option>
                    <option value="7">APPARTAMENTO 7</option>
                    <option value="8">APPARTAMENTO 8</option>
                    <option value="9">APPARTAMENTO 9</option>
                    <option value="10">APPARTAMENTO 10</option>
                    <option value="11">APPARTAMENTO 11</option>
                    <option value="12">APPARTAMENTO 12</option>
                    <option value="13">APPARTAMENTO 13</option>
                    <option value="14">APPARTAMENTO 14</option>
                    <option value="15">APPARTAMENTO 15</option>
                    <option value="16">APPARTAMENTO 16</option>
                    <option value="17">APPARTAMENTO 17</option>
                    <option value="18">APPARTAMENTO 18</option>
                    <option value="19">APPARTAMENTO 19</option>
                    <option value="20">APPARTAMENTO 20</option>
                    <option value="21">APPARTAMENTO 21</option>
                    <option value="22">APPARTAMENTO 22</option>
                    <option value="23">APPARTAMENTO 23</option>
                    <option value="24">APPARTAMENTO 24</option>
                    <option value="25">APPARTAMENTO 25</option>
                    <option value="26">APPARTAMENTO 26</option>
                    <option value="27">APPARTAMENTO 27</option>
                    <option value="28">APPARTAMENTO 28</option>
                    <option value="29">APPARTAMENTO 29</option>
                    <option value="30">APPARTAMENTO 30</option>
                    <option value="31">APPARTAMENTO 31</option>
                    <option value="32">APPARTAMENTO 32</option>
                    <option value="33">APPARTAMENTO 33</option>
                    <option value="34">APPARTAMENTO 34</option>
                    <option value="35">APPARTAMENTO 35</option>
                    <option value="36">APPARTAMENTO 36</option>
                    <option value="37">APPARTAMENTO 37</option>
                    <option value="38">APPARTAMENTO 38</option>
                    <option value="39">APPARTAMENTO 39</option>
                    <option value="40">APPARTAMENTO 40</option>
                    <option value="41">APPARTAMENTO 41</option>
                    <option value="42">APPARTAMENTO 42</option>
                    <option value="43">APPARTAMENTO 43</option>
                    <option value="44">APPARTAMENTO 44</option>
                    <option value="45">APPARTAMENTO 45</option>
                    <option value="46">APPARTAMENTO 46</option>
                    <option value="47">APPARTAMENTO 47</option>
                    <option value="48">APPARTAMENTO 48</option>
                    <option value="49">APPARTAMENTO 49</option>
                    <option value="50">APPARTAMENTO 50</option>
                    <option value="51">APPARTAMENTO 51</option>
                    <option value="52">APPARTAMENTO 52</option>
                    <option value="53">APPARTAMENTO 53</option>
                    <option value="54">APPARTAMENTO 54</option>
                    <option value="55">APPARTAMENTO 55</option>
                    <option value="56">APPARTAMENTO 56</option>
                    <option value="57">APPARTAMENTO 57</option>
                    <option value="58">APPARTAMENTO 58</option>
                    <option value="59">APPARTAMENTO 59</option>
                    <option value="60">APPARTAMENTO 60</option>
                </select>
            </fieldset>
            <input class="submit" type="submit" value="ASSEGNA" name="submit">
            <section class="white__space__prenota">
                <span></span>
                <span></span>
                <span></span>
            </section>
            <a href="stato.html">
                <p id="rimasti" class="disponibili"></p>
            </a>
        </form>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script>
        $(document).ready(function() {

            $(".header__icon-bar").click(function(e) {

                $(".header__menu").toggleClass('is-open');
                e.preventDefault();
            });
        });
    </script>
    <script>
        const wrapper = document.querySelector('.wrapper'),
            form = wrapper.querySelectorAll('.form'),
            submitInput = form[0].querySelector('input[type="submit"]');

        function getDataForm(e) {
            e.preventDefault();
            var formData = new FormData(form[0]);
            index = parseInt(formData.get('numero')) - 1
            day = JSON.parse(localStorage.getItem('giorno')).toString()
            month = JSON.parse(localStorage.getItem('mese')).toString()
            time = JSON.parse(localStorage.getItem('orario')).toString()
            list_container = time + month + day
            counter_container = 'c' + list_container
            tmp = JSON.parse(localStorage.getItem(list_container))
            if (!tmp) {
                tmp = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
                ]
                localStorage.setItem(list_container, JSON.stringify(tmp))
                localStorage.setItem(counter_container, 0)
            }
            if (tmp[index] != 0) {
                alert('Posto giÃ  assegnato: ' + tmp[index])
                window.location.href = "index.html"
            } else {
                qty = parseInt(localStorage.getItem(counter_container))
                if (qty >= 11 && qty < 31) {
                    do {
                        rand = Math.floor(Math.random() * 20) + 12;
                    } while (tmp.includes(rand))
                    tmp[index] = rand
                } else if (qty < 11) {
                    do {
                        rand = Math.floor(Math.random() * 11) + 1;
                    } while (tmp.includes(rand))
                    tmp[index] = rand
                } else {
                    alert("Posti esauriti!")
                    window.location.href = "index.html"
                }
                localStorage.setItem(list_container, JSON.stringify(tmp))
                alert('Posto assegnato: ' + rand)
                tmp2 = parseInt(localStorage.getItem(counter_container)) + 1
                localStorage.setItem(counter_container, tmp2)
                window.location.href = "index.html"
            }
        }
        document.addEventListener('DOMContentLoaded', function() {
            submitInput.addEventListener('click', getDataForm, false);
        }, false);
    </script>
    <script>
        day = JSON.parse(localStorage.getItem('giorno')).toString()
        switch (month = JSON.parse(localStorage.getItem('mese')).toString()) {
            case '6':
                mese = 'giugno'
                break
            case '7':
                mese = 'luglio'
                break
            case '8':
                mese = 'agosto'
                break
            case '9':
                mese = 'settembre'
                break
        }
        document.getElementById('data').innerHTML = day + ' ' + mese + ' 2021'
        time = JSON.parse(localStorage.getItem('orario')).toString()
        if (time == '0') {
            document.getElementById('ora').innerHTML = '9:00-13:30'
        } else if (time == '1') {
            document.getElementById('ora').innerHTML = '14:30-19:00'
        }
    </script>
    <script>
        day = JSON.parse(localStorage.getItem('giorno')).toString()
        month = JSON.parse(localStorage.getItem('mese')).toString()
        time = JSON.parse(localStorage.getItem('orario')).toString()
        counter_container = 'c' + time + month + day
        tmp = JSON.parse(localStorage.getItem(counter_container))
        if (tmp) {
            remaining = (31 - parseInt(tmp))
            document.getElementById('rimasti').innerHTML = remaining.toString() + ' su 31 disponibili'
        } else {
            document.getElementById('rimasti').innerHTML = '31 su 31 disponibili'
        }
    </script>
</body>

</html>